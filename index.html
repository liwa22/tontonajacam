<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>STREAM ENAK</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

  <style>
    body {
      background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
      color: white;
      min-height: 100vh;
      font-family: 'Poppins', sans-serif;
      display: flex;
      flex-direction: column;
    }

    header {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
    }

    .video-container {
      width: 100%;
      max-width: 900px;
      margin: 20px auto;
      position: relative;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 10px 40px rgba(0,0,0,0.3);
    }

    .loading-spinner {
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-top: 4px solid white;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 20;
      display: none;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    footer {
      background: rgba(255, 255, 255, 0.1);
      text-align: center;
      padding: 15px;
      backdrop-filter: blur(10px);
      font-size: 14px;
    }

    .playlist-item {
      cursor: pointer;
      padding: 10px 15px;
      border-radius: 10px;
      transition: background 0.2s;
    }

    .playlist-item:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    .playlist-active {
      background: rgba(255, 255, 255, 0.3);
      font-weight: 600;
    }
  </style>
</head>

<body>
  <header class="py-4 px-6 flex justify-between items-center shadow">
    <h1 class="text-2xl font-bold">ðŸŽ¬ STREAM ENAK</h1>
    <a href="https://videi.my.id/" class="bg-white text-blue-600 px-4 py-2 rounded-full font-semibold hover:bg-gray-200 transition">
      <i class="fas fa-upload mr-1"></i> Upload
    </a>
  </header>

  <main class="flex-grow px-4">
    <div class="video-container">
      <div class="loading-spinner" id="loading-spinner"></div>
      <video id="video-player" controls controlsList="nodownload noremoteplayback" disablePictureInPicture class="w-full h-auto rounded-xl">
        Browser tidak mendukung video tag.
      </video>
    </div>

    <div id="error-message" class="text-center text-red-300 mt-4 hidden"></div>

    <section class="max-w-3xl mx-auto mt-6 text-center">
      <h2 id="video-title" class="text-3xl font-bold mb-2">Judul Video</h2>
      <p id="video-description" class="text-white/80 mb-4">Deskripsi video akan muncul di sini.</p>
      <button id="share-button" class="bg-white text-blue-600 px-5 py-2 rounded-full font-semibold hover:bg-gray-200 transition">
        <i class="fas fa-share-alt mr-2"></i>Share
      </button>
    </section>

    <section class="max-w-3xl mx-auto mt-8 bg-white/10 rounded-2xl p-4">
      <h3 class="text-xl font-bold mb-3">ðŸŽµ Playlist Lainnya</h3>
      <div id="playlist" class="space-y-2"></div>
    </section>
  </main>

  <footer>
    &copy; 2026 Videy. All rights reserved.
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      const jsonUrl = "https://raw.githubusercontent.com/liwa22/json/refs/heads/main/Video.json";
      const player = document.getElementById('video-player');
      const spinner = document.getElementById('loading-spinner');
      const title = document.getElementById('video-title');
      const desc = document.getElementById('video-description');
      const error = document.getElementById('error-message');
      const playlistContainer = document.getElementById('playlist');
      const shareButton = document.getElementById('share-button');
      let videos = [];
      let currentVideoId = '';

      // Dapatkan video ID dari URL
      let urlPath = window.location.pathname;
      if (urlPath.startsWith('/')) urlPath = urlPath.substring(1);
      if (urlPath.startsWith('e/')) currentVideoId = urlPath.substring(2);
      else currentVideoId = urlPath;

      spinner.style.display = 'block';

      try {
        const response = await axios.get(jsonUrl, { timeout: 10000 });
        videos = response.data;

        if (!Array.isArray(videos) || videos.length === 0) throw new Error('Data JSON kosong.');

        const found = videos.find(v => v.id === currentVideoId) || videos[0];
        loadVideo(found);

        // Buat playlist otomatis
        videos.forEach(v => {
          const item = document.createElement('div');
          item.className = 'playlist-item text-white';
          item.textContent = v.Judul || 'Tanpa Judul';
          item.onclick = () => loadVideo(v);
          if (v.id === found.id) item.classList.add('playlist-active');
          playlistContainer.appendChild(item);
        });
      } catch (err) {
        error.textContent = 'Gagal memuat video. Cek koneksi atau file JSON.';
        error.classList.remove('hidden');
      } finally {
        spinner.style.display = 'none';
      }

      function loadVideo(video) {
        if (!video) return;
        player.src = video.Url;
        title.textContent = video.Judul || 'Tanpa Judul';
        desc.textContent = video.Description || 'Tidak ada deskripsi.';
        error.classList.add('hidden');

        // Update playlist aktif
        document.querySelectorAll('.playlist-item').forEach(item => item.classList.remove('playlist-active'));
        const active = Array.from(document.querySelectorAll('.playlist-item')).find(i => i.textContent === video.Judul);
        if (active) active.classList.add('playlist-active');
      }

      // Tombol Share
      shareButton.addEventListener('click', async () => {
        const currentUrl = window.location.href;
        try {
          await navigator.clipboard.writeText(currentUrl);
          const original = shareButton.innerHTML;
          shareButton.innerHTML = '<i class="fas fa-check mr-2"></i>Tersalin!';
          setTimeout(() => shareButton.innerHTML = original, 2000);
        } catch {
          alert('Gagal menyalin link. Salin manual: ' + currentUrl);
        }
      });

      // Anti klik kanan
      player.addEventListener('contextmenu', e => e.preventDefault());
    });
  </script>
</body>
</html>
